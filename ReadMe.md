
# RAG (Retrieval Augmented Generation)  

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–æ–µ–∫—Ç —è–≤–ª—è–µ—Ç—Å—è —É—á–µ–±–Ω—ã–º –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ RAG –ø–∞–π–ø–ª–∞–π–Ω–∞. –û–ø–∏—à–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–ª–∞–Ω–∏—Ä—É–µ–º–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞:

```markdown
<RAG>
‚îú‚îÄ‚îÄ <img>/*
‚îÇ   ‚îî‚îÄ‚îÄ <<–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ä–∏—Å—É–Ω–∫–∏>>
‚îÇ
‚îú‚îÄ‚îÄ <data>/*
‚îÇ   ‚îî‚îÄ‚îÄ <<–ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ>>
‚îÇ
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ docker-compose.yml
‚îú‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ rag_llm.ipynb
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
```

-- -- --
–ù—É —á—Ç–æ–∂, –ø—Ä–∏—Å—Ç—É–ø–∏–º –∫ –æ–ø—Å–∏—Å–∞–Ω–∏—é –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ üòä

## RAG   

RAG (Retrieval-Augmented Generation) ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π —Å–æ—á–µ—Ç–∞–µ—Ç –ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ (retrieval) —Å –≥–µ–Ω–µ—Ä–∞—Ü–∏–µ–π —Ç–µ–∫—Å—Ç–∞ (generation) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–æ–≤. 

–ò–∑–æ–±—Ä–∞–∑–∏–º —Å—Ö–µ–º—É –ø—Ä–æ—Å—Ç–æ–≥–æ RAG:  
![–ë–ª–æ–∫ —Å—Ö–µ–º–∞ RAG (–ø—Ä–æ—Å—Ç–∞—è –≤–µ—Ä—Å–∏—è)](img/simple_rag.svg)

–ü–æ–ø—Ä–æ–±—É–µ–º —Å–æ–±—Ä–∞—Ç—å —Å–∏—Å—Ç–µ–º—É RAG —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤, –ø—Ä–∏–º–µ–Ω—è—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ llama_index –∏ llama_parse. –¢–∞–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ ¬´–∏–∑ –∫–æ—Ä–æ–±–∫–∏¬ª –≤–ø–æ–ª–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –Ω–µ–±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–æ –∏–º–µ–µ—Ç —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –º–∏–Ω—É—Å - –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–º–µ—é—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç–æ–∫–µ–Ω–æ–≤ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å —Ä–∞–±–æ—á–µ–µ —Ä–µ—à–µ–Ω–∏–µ, –æ–¥–Ω–∞–∫–æ –æ–Ω–æ –±—É–¥–µ—Ç –∏–º–µ—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –≤ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç–∏.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–ø—Ä–æ–±—É–µ–º —Å–æ–±—Ä–∞—Ç—å —Å–∏—Å—Ç–µ–º—É —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ. –í –Ω–∞—à–µ–º –ø—Ä–æ–µ–∫—Ç–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã -> Ollama + Weaviate.

–í –∫–∞—á–µ—Å—Ç–≤–µ LLM –≤–æ–∑—å–º—ë–º –º–æ–¥–µ–ª—å -- [qwen2.5:0.5b](https://ollama.com/library/qwen2.5:0.5b)  

–ö—Ä–∞—Ç–∫–æ –æ–ø–∏—à–µ–º –º–æ–¥–µ–ª—å:

- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 0.49B
- –ù–µ—ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã: 0.36B
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–µ–≤: 24
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤ (KV): 14 / 2
- –°–≤—è–∑–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤: –î–∞
- –î–ª–∏–Ω–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: 32K —Ç–æ–∫–µ–Ω–æ–≤
- –î–ª–∏–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: 8K —Ç–æ–∫–µ–Ω–æ–≤

–¢–∞–∫ –∂–µ —Å—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å —á—Ç–æ –º–æ–¥–µ–ª—å - –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–∞—è –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫.  
–ë–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å [—Ç—É—Ç](https://qwenlm.github.io/blog/qwen2.5-llm/)

–í –∫–∞—á–µ—Å—Ç–≤–µ –≤–µ–∫—Ç–æ—Ä–∏–∑–∞—Ç–æ—Ä–∞ –Ω–∞–º–∏ –±—ã–ª –≤—ã–±—Ä–∞–Ω -- [nextfire/paraphrase-multilingual-minilm](https://ollama.com/nextfire/paraphrase-multilingual-minilm)

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –±—ã–ª–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ —Ñ–æ—Ä–º–∞—Ç–∞ .pdf –∏–∑ –ø–∞–ø–∫–∏ data. –î–∞–ª–µ–µ –º—ã –æ–±—Ä–∞–±–æ—Ç–∞–ª–∏ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–∞—Ä–µ–∑–∞–ª–∏ –∏—Ö –Ω–∞ –Ω–µ–±–æ–ª—å—à–∏–µ –∫—É—Å–∫–∏; –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ –æ–± —ç—Ç–æ–º –º–æ–∂–Ω–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤ –±–ª–æ–∫–Ω–æ—Ç–µ.

–ó–∞—Ç–µ–º –º—ã –ø—Ä–∏—Å—Ç—É–ø–∏–ª–∏ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø–æ–∏—Å–∫–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞. –ò—Å–∫–∞—Ç—å –º—ã –±—É–¥–µ–º —Å –ø–æ–º–æ—â—å—é HNSW (–ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã –æ–ø–∏—Å–∞–Ω –Ω–∏–∂–µ) –∞ —Ç–∞–∫–∂–µ —Å –ø–æ–º–æ—â—å—é –ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞. –§–∏–Ω–∞–ª—å–Ω—ã–º–∏ —à–∞–≥–∞–º–∏, —è–≤–ª—è–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–µ—Ç—Ä–∏–≤–µ—Ä–∞, –∏ —Å–±–æ—Ä–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ –ø–∞–π–ø–ª–∞–π–Ω–∞

### –ú–µ—Ö–∞–Ω–∏–∑–º HNSW
–î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ–∏—Å–∫–∞ —Ç–µ–∫—Å—Ç–∞, –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å ->  
**Hierarchical Navigable Small World (HNSW)** --  —ç—Ç–æ –∞–ª–≥–æ—Ä–∏—Ç–º –¥–ª—è –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π (nearest neighbors) –≤ –≤—ã—Å–æ–∫–æ—Ä–∞–∑–º–µ—Ä–Ω—ã—Ö –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞—Ö

–ì—Ä–∞—Ñ —Å—Ç—Ä–æ–∏—Ç—Å—è –≤ –≤–∏–¥–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É—Ä–æ–≤–Ω–µ–π:
 - –í–µ—Ä—Ö–Ω–∏–µ —É—Ä–æ–≤–Ω–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –º–µ–Ω—å—à–µ —É–∑–ª–æ–≤, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å—Ç–∞—Ä—Ç–æ–≤—É—é —Ç–æ—á–∫—É –¥–ª—è –ø–æ–∏—Å–∫–∞.
 - –ù–∏–∂–Ω–∏–µ —É—Ä–æ–≤–Ω–∏ –±–æ–ª–µ–µ –ø–ª–æ—Ç–Ω—ã–µ, —á—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç —Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ–∏—Å–∫–∞.

![HNSW](img/HNSW.svg)


–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –∫—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∞–ª–≥–æ—Ç—Ä–∏—Ç–º–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–µ–¥—É—â–∏–º - –ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞—á–∏–Ω–∞–µ—Ç –ø–æ–∏—Å–∫ —Å –≤–µ—Ä—Ö–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è –∏ –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ —Å–ø—É—Å–∫–∞–µ—Ç—Å—è –≤–Ω–∏–∑, –∏—Å–ø–æ–ª—å–∑—É—è –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏ –¥–ª—è –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏—è –∫ –∏—Å–∫–æ–º–æ–π —Ç–æ—á–∫–µ.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã
–í –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–º —Ä–∞–∑–≤–∏—Ç–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å RAG –¥–æ–±–∞–≤–∏–≤:
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä
- –ê–≥–µ–Ω—Ç–Ω—É—é —Å–∏—Å—Ç–µ–º—É
- –î–æ–±–∞–≤–∏—Ç—å –≤–æ–∑–º–æ–∂–¥–Ω–æ—Å—Ç—å —Å–≤–µ—Ä—è—Ç—å –≤–æ–ø—Ä–æ—Å –∏ –æ—Ç–≤–µ—Ç —Å –ø–æ–º–æ—â—å—é Cross-Encoder –∏–ª–∏ Bi-Encoder


–ü–æ—Å—Ç—Ä–æ–∏–º –±–æ–ª–µ–µ –ø–æ–ª–Ω—É—é –±–ª–æ–∫ —Å—Ö–µ–º—É


```plaintext
                –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                    |
            [–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –≤–æ–ø—Ä–æ—Å–æ–≤]
                    |
             [–ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤]
             /       |       |       \
  [–ê–≥–µ–Ω—Ç 1]   [–ê–≥–µ–Ω—Ç 2]   [–ê–≥–µ–Ω—Ç 3]   [–ó–∞—â–∏—Ç–Ω–∏–∫]
      |             |             |             |
[–û—Ç–≤–µ—Ç 1]     [–û—Ç–≤–µ—Ç 2]     [–û—Ç–≤–µ—Ç 3]     [–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞]
                    \         |         /
                     \       [–ê–Ω–∞–ª–∏–∑] /
                      \        |      /
                       [–ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç–≤–µ—Ç]

```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- **rag_llm.ipynb**: Jupyter Notebook —Å –∫–æ–¥–æ–º —Å –∫–æ–¥–æ–º –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã RAG, –≤–∫–ª—é—á–∞—è –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫—É –º–æ–¥–µ–ª–∏.
- **requirements.txt**: –§–∞–π–ª —Å–æ —Å–ø–∏—Å–∫–æ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–¥–∞.
- **docker-compose.yml**: –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è Docker Compose, –∫–æ—Ç–æ—Ä—ã–π –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Å–µ—Ä–≤–∏—Å—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Dockerfile**: –°–∫—Ä–∏–ø—Ç –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è Docker –æ–±—Ä–∞–∑–∞
- **data/**: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∞—è –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞.
- **img/**: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è, –≤ –∫–æ—Ç–æ—Ä–æ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è.
- **.gitignore**: –§–∞–π–ª, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π Git –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.
- **README.md**: –î–æ–∫—É–º–µ–Ω—Ç —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–µ–∫—Ç–∞.


## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–µ–∫—Ç
1. –°–∫–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ —Å–≤–æ–π –∫–æ–º–ø—å—é—Ç–µ—Ä.
2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–æ–∫–µ—Ä –æ–±—Ä–∞–∑ `docker-compose.yml`
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ —Ñ–∞–π–ª–µ `requirements.txt`.
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ Jupyter notebook `rag_llm.ipynb`, —Å–ª–µ–¥—É—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ –Ω—ë–º.

## –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø—Ä–æ–µ–∫—Ç–∞, —Å–≤—è–∂–∏—Ç–µ—Å—å —Å–æ –º–Ω–æ–π:
- Email: maximgoltsov@gmail.com





